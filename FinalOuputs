Question:1-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1.Find the hottest and coldest day along the station code and date for each year.
#2010Maximum
+-------+--------+-----+
|    STN|YEARMODA|  MAX|
+-------+--------+-----+
|'720667|20100923|132.8|
+-------+--------+-----+
#2010Minimum
+-------+--------+------+
|    STN|YEARMODA|   MIN|
+-------+--------+------+
|'896060|20100802|-115.2|
+-------+--------+------+
------------------------------------------------
#2011Maximum
+-------+--------+-----+
|    STN|YEARMODA|  MAX|
+-------+--------+-----+
|'720293|20110613|131.0|
+-------+--------+-----+
#2011Minimum
+-------+--------+------+
|    STN|YEARMODA|   MIN|
+-------+--------+------+
|'897340|20110917|-111.8|
+-------+--------+------+
------------------------------------------------
#2012Maximum
+-------+--------+-----+
|    STN|YEARMODA|  MAX|
+-------+--------+-----+
|'722577|20120712|132.8|
+-------+--------+-----+
#2012Minimum
+-------+--------+------+
|    STN|YEARMODA|   MIN|
+-------+--------+------+
|'896060|20120916|-119.6|
+-------+--------+------+
--------------------------------------------------
#2013Maximum
+-------+--------+-----+
|    STN|YEARMODA|  MAX|
+-------+--------+-----+
|'406890|20130712|132.8|
+-------+--------+-----+
#2013Minimum
+-------+--------+------+
|    STN|YEARMODA|   MIN|
+-------+--------+------+
|'895770|20130730|-115.1|
+-------+--------+------+
---------------------------------------------------
#2014Maximum
+-------+--------+-----+
|    STN|YEARMODA|  MAX|
+-------+--------+-----+
|'406650|20140803|129.6|
+-------+--------+-----+
#2014Minimum
+-------+--------+------+
|    STN|YEARMODA|   MIN|
+-------+--------+------+
|'896060|20140821|-113.4|
+-------+--------+------+
-----------------------------------------------------
#2015Maximum
+-------+--------+-----+
|    STN|YEARMODA|  MAX|
+-------+--------+-----+
|'916700|20151021|132.4|
+-------+--------+-----+
#2015Minimum
+-------+--------+------+
|    STN|YEARMODA|   MIN|
+-------+--------+-----+
|'895770|20150917|-114.2|
+-------+--------+------+
------------------------------------------------------
#2016Maximum
+-------+--------+-----+
|    STN|YEARMODA|  MAX|
+-------+--------+-----+
|'700638|20160622|129.0|
+-------+--------+-----+
#2016Minimum
+-------+--------+------+
|    STN|YEARMODA|   MIN|
+-------+--------+------+
|'896060|20160712|-115.1|
+-------+--------+------+
---------------------------------------------------------
#2017Maximum
+-------+--------+-----+
|    STN|YEARMODA|  MAX|
+-------+--------+-----+
|'917430|20170410|129.6|
+-------+--------+-----+
#2017Minimum
+-------+--------+------+
|    STN|YEARMODA|   MIN|
+-------+--------+------+
|'896250|20170620|-116.0|
+-------+--------+------+
-----------------------------------------------------------
#2018Maximum
+-------+--------+-----+
|    STN|YEARMODA|  MAX|
+-------+--------+-----+
|'408110|20180702|126.3|
+-------+--------+-----+
#2018Minimum
+-------+--------+------+
|    STN|YEARMODA|   MIN|
+-------+--------+------+
|'896060|20180828|-116.3|
+-------+--------+------+
-------------------------------------------------------------
#2019Maximum
+-------+--------+-----+
|    STN|YEARMODA|  MAX|
+-------+--------+-----+
|'956660|20190124|121.1|
+-------+--------+-----+
#2019Minimum
+-------+--------+------+
|    STN|YEARMODA|   MIN|
+-------+--------+------+
|'896060|20190405|-102.1|
+-------+--------+------+
-------------------------------------------------------------

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Question:2-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2.Find the hottest and coldest day across all years (2010 - 2019) along with station code and date.
#Hottest Day of all years
+------+--------+-----+                                                 
|   STN|YEARMODA|  MAX|
+------+--------+-----+
|720667|20100923|132.8|
|722577|20120712|132.8|
|406890|20130712|132.8|
+------+--------+-----+
---------------------------------------------------
#Colderst Day of all years
+------+--------+------+                                                 
|   STN|YEARMODA|   MIN|
+------+--------+------+
|896060|20120916|-119.6|
+------+--------+------+
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#Question:3-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3.	Maximum and minimum precipitation with station code and date for year 2015.
#Maximum Precipitation in 2015
#With LIMIT 1
>>> spark.sql("Select distinct(STN),YEARMODA,PRCP from cleanData2015 where PRCP in (select MAX(PRCP) from cleanData2015 where PRCP!='99.99') LIMIT 1").show()

+-------+--------+------+
|    STN|YEARMODA|  PRCP|
+-------+--------+------+
|'915410|20150311|19.49G|
+-------+--------+------+

------------------------------------------------------

#Minimum precipitation in 2015
>>> spark.sql("Select distinct(STN),YEARMODA,PRCP from cleanData2015 where PRCP in (select MIN(PRCP) from cleanData2015 where PRCP!='99.99')").show()
+-------+--------+-----+
|    STN|YEARMODA| PRCP|
+-------+--------+-----+
|'719740|20150127|0.00A|
|'717820|20151016|0.00A|
|'717830|20150305|0.00A|
|'941270|20150522|0.00A|
|'941370|20150719|0.00A|
|'715920|20150914|0.00A|
|'115670|20150809|0.00A|
|'711720|20150608|0.00A|
|'711990|20151202|0.00A|
|'118560|20150721|0.00A|
|'118560|20150902|0.00A|
|'025870|20151031|0.00A|
|'085450|20150105|0.00A|
|'802590|20151229|0.00A|
|'842030|20151213|0.00A|
|'688280|20150520|0.00A|
|'688280|20150606|0.00A|
|'800220|20151027|0.00A|
|'080940|20150208|0.00A|
|'080940|20150626|0.00A|
+-------+--------+-----+
only showing top 20 rows
#With LIMIT 1
>>> spark.sql("Select distinct(STN),YEARMODA,PRCP from cleanData2015 where PRCP in (select MIN(PRCP) from cleanData2015 where PRCP!='99.99') LIMIT 1").show()
+-------+--------+-----+
|    STN|YEARMODA| PRCP|
+-------+--------+-----+
|'702628|20151020|0.00A|
+-------+--------+-----+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#Question:4-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4.Count percentage missing values for mean station pressure (STP) for year 2019 and stations.
Total_Values=cleanData2019.count()                                            
Missing_Values=cleanData2019.where("STP='9999.9'")                              
Missing_Values=Missing_Values.count()
Percentage = (Missing_Values/float(Total_Values)) * 100
print(Percentage)
27.961149261
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

#Question:5-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5.Station code with maximum wind gust and date for year 2019 
>>>spark.sql("Select STN,YEARMODA,GUST from cleanData2019 where GUST = (select MAX(GUST) from cleanData2019 where GUST <> 999.9)").show()
+-------+--------+-----+
|    STN|YEARMODA| GUST|
+-------+--------+-----+
|'085510|20190101|116.6|
+-------+--------+-----+




